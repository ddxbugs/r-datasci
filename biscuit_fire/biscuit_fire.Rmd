---
title: "biscuit_fire"
author: "ddxbugs"
date: "2024-02-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<h5>Oregon Biscuit Fire 2002</h5>

<h6>When wildfires ravage forests, the timber industry argues that logging the burned trees enhances forest recovery; the EPA argues the opposite. The 2002 Biscuit Fire in southwest Oregon provided a test case.  Researchers selected 16 fire-affected plots in 2004, before any logging was done and counted tree seedlings along a randomly located transect pattern in each plot.  They returned in 2005, after nine of the plots had been logged, and counted the tree seedlings along the same transects.  The percent of seedlings lost from 2004 to 2005 is recorded in the file logging.csv for logged (L) and unlogged (U) plots:</h6>

<h6>Test the EPA’s assertion (and thus the opposite of the logging industries assertion) that logging actually increases the percentage of seedlings lost from 2004 to 2005.</h6>

<ul>
<li>Perform a complete analysis using a rank sum test in SAS. (Logging data).</li>
<li>Verify the p-value and confidence interval by running the rank sum test in R (using R function Wilcox.test).</li>
<li>Finally, perform a permutation test for the difference of means.  As with all ”tests”, this should include a clear conclusion written in the context of the problem and in terms understandable by a client (although it should also include a pvalue.)</li>
</ul>

<h5>Import data set</h5>
```{r}
library(dplyr)
loggingDF <- read.csv("Logging.csv", header=TRUE)
loggingDF

```
<h5>Tidy & Transform data set</h5>
```{r}
loggingDF %>% group_by(Action) %>% summarize(
  count <- n(),
  median <- median(PercentLost, na.rm=TRUE),
  IQR <- IQR(PercentLost, na.rm=TRUE)
)
actionU <- loggingDF %>% filter(Action == "U")
actionL <- loggingDF %>% filter(Action == "L")
```

<h5>Wilcoxon Rank Sum Test</h5>
```{r}
wilcox.test(actionU$PercentLost, actionL$PercentLost, exact=TRUE)
wilcox.test(actionU$PercentLost, actionL$PercentLost, exact=TRUE, alternative="l")
wilcox.test(actionU$PercentLost, actionL$PercentLost, exact=FALSE, alternative="g")
```
<h5>Permutation Test</h5>
```{r}
number_of_permutations <- 10000
xbarholder <- c()
counter <- 0
observed_difference <- mean(subset(loggingDF, Action=="L")$PercentLost) - mean(subset(loggingDF, Action=="U")$PercentLost)
for (i in 1:number_of_permutations) {
  scramble <- sample(loggingDF$PercentLost, 16)
  logged <- scramble[1:9]
  unlogged <- scramble[10:16]
  difference <- mean(logged) - mean(unlogged)
  xbarholder[i] <- difference
  if (difference >= observed_difference)
    counter <- counter + 1
}
hist(xbarholder, col="lightblue", main=paste("Differences of Means Under Null Distribution, n=", 16), xlab="Difference in Means")
abline(v=observed_difference, col="red", lwd=3)
p_value <- counter/number_of_permutations
p_value
```