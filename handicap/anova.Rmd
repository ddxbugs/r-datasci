---
title: "anova"
author: "ddxbugs"
date: "2024-02-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
# install.packages("agricolae")
# install.packages("multcomp")

library(emmeans)
library(agricolae)
library(ggplot2)
library(multcomp)
library(onewaytests)
library(car)
```
# Data import and preprocessing
```{r}
df <- read.csv("handicap.csv")

str(df)
df$Handicap <- factor(df$Handicap)
unique(df$Handicap)
```
# Exploratory Data Analysis
```{r}
ggplot(df, aes(Score, fill=Handicap)) + geom_histogram(binwidth=1) + facet_grid(~Handicap) + labs(x="Score", y="Frequency", title="Histogram by Handicap")
ggplot(df, aes(Handicap, Score, fill=Handicap)) + geom_boxplot() + labs(x="Handicap", y="Score", title="Boxplot by Handicap")
```
# Preliminary analysis of variance
```{r}
leveneTest(Score~Handicap, data=df)
bf.test(Score~Handicap, data=df)
```

```{r}
fit <- lm(Score~Handicap, data=df)
leastsquare <- lsmeans(fit, "Handicap")
contrasts <- list(constrast <- c(0.5, -0.5, 0.5, 0, -0.5))
contrast(leastsquare, contrasts, adjust="sidak")
contrast(leastsquare, contrasts)
```

```{r}
aov <- aov(Score~Handicap, data=df)

df.bon <- LSD.test(aov, 'Handicap', p.adj='bonferroni')
df.lsd <- LSD.test(aov, 'Handicap', p.adj='none')
df.scheffe <- scheffe.test(aov, 'Handicap')
df.tukey <- HSD.test(aov, 'Handicap')

df.bon
df.lsd
df.scheffe
df.tukey
```

```{r}
fit <- lm(Score~Handicap, data=df)
gfit <- glht(fit, linfct=mcp(Handicap="Tukey"))
summary(gfit, test=adjusted(type="none"))
confint(gfit)
```
